<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.5">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px Courier; -webkit-text-stroke: #000000}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px Courier; -webkit-text-stroke: #000000; min-height: 16.0px}
    span.s1 {font-kerning: none}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE html&gt;</span></p>
<p class="p1"><span class="s1">&lt;html lang="en"&gt;</span></p>
<p class="p1"><span class="s1">&lt;head&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;meta charset="utf-8" /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1" /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;meta name="theme-color" content="#00ffe1" /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;title&gt;Mission Secure (Level 3 App)&lt;/title&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;!-- Optional (for PWA installs). Keep these if you're hosting with manifest + sw.js. --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;link rel="manifest" href="./manifest.webmanifest" /&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;style&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>:root { color-scheme: dark; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>* { box-sizing: border-box; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>body{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>margin:0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>font-family: Arial, sans-serif;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>background: radial-gradient(circle at center, #00111a, #000);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>color:#00ffe1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>text-align:center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 12px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>h1{ margin: 8px 0 6px; font-size: 22px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>#wrap{ max-width: 980px; margin: 0 auto; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>#gameBox{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>border:2px solid #00ffe1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 14px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>background: rgba(0,20,30,.9);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>box-shadow:0 0 20px #00ffe1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>border-radius: 12px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>#scenario{ font-size: 18px; margin: 10px 0 14px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>#hud{ margin-top: 10px; font-size: 14px; opacity: .95; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>.row{ display:flex; justify-content:center; gap:10px; flex-wrap: wrap; margin-top: 10px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>button{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 12px 14px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>margin: 6px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>background:#002b36;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>color:#00ffe1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>border:1px solid #00ffe1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>cursor:pointer;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>font-size: 14px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>border-radius: 10px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>min-width: 220px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>button:hover{ background:#004d40; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>button:disabled{ opacity: .45; cursor:not-allowed; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>#buttons{ display:flex; flex-wrap: wrap; justify-content:center; gap: 6px; }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>#map{ margin-top: 10px; font-size: 14px; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>.node{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 6px 10px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>border:1px solid #00ffe1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>display:inline-block;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>margin: 6px 6px 0 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>border-radius: 999px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>white-space: nowrap;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>.infected{ color:#ff4d4d; border-color:#ff4d4d; }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>.small{ font-size: 12px; opacity: .9; margin-top: 8px; }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>#toast{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>position: fixed; left: 50%; transform: translateX(-50%);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>bottom: 16px; background: rgba(0,0,0,.78);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>border: 1px solid #00ffe1; padding: 10px 12px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>border-radius: 12px; display:none; max-width: 92vw;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>#leaderboard{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>margin-top: 12px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>text-align:left;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>border-top: 1px solid rgba(0,255,225,.25);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>padding-top: 10px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>display:none;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>table{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>width:100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>border-collapse: collapse;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>margin-top: 8px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>font-size: 14px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>th, td{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>border-bottom: 1px solid rgba(0,255,225,.2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 8px 6px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>th{ text-align:left; opacity:.95; }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>/* Team name entry (no prompt()) */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>#nameEntry{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>display:none;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>margin-top: 12px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 12px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>border: 1px solid rgba(0,255,225,.25);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>border-radius: 12px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>background: rgba(0,0,0,.25);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>text-align:center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>#teamNameInput{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>width: min(420px, 92%);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 10px 12px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>margin-top: 8px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>border-radius: 10px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>border: 1px solid #00ffe1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>background:#00111a;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>color:#00ffe1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>outline: none;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>font-size: 14px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>#teamNameInput::placeholder{ color: rgba(0,255,225,.65); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;/style&gt;</span></p>
<p class="p1"><span class="s1">&lt;/head&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;body&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;div id="wrap"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;h1&gt;ğŸš€ Mission Secure (Level 3 App)&lt;/h1&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="row"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;button id="startBtn"&gt;Start Mission&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;button id="dlBtn" disabled&gt;Download Leaderboard (CSV)&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;button id="installBtn" style="display:none;"&gt;Install App&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;div id="gameBox"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div id="scenario"&gt;Press &lt;b&gt;Start Mission&lt;/b&gt; to begin.&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div id="buttons"&gt;&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div id="hud"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>â± &lt;span id="time"&gt;90&lt;/span&gt;s |</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>â¤ï¸ &lt;span id="health"&gt;100&lt;/span&gt;% |</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>â­ &lt;span id="score"&gt;0&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div id="map"&gt;&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div id="nameEntry"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;b&gt;Enter Team Name&lt;/b&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="small"&gt;This avoids pop-ups (prompt) that can be blocked on managed school computers.&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;input id="teamNameInput" type="text" maxlength="30" placeholder="Team Atlas" autocomplete="off" /&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="row" style="margin-top:8px;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;button id="saveTeamBtn" style="min-width: 220px;"&gt;Save Score&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;button id="skipSaveBtn" style="min-width: 220px;"&gt;Skip&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div id="leaderboard"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;b&gt;Leaderboard&lt;/b&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="small"&gt;Stored on this device (offline-friendly). Download anytime.&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;table id="lbTable"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;thead&gt;&lt;tr&gt;&lt;th&gt;Team&lt;/th&gt;&lt;th&gt;Score&lt;/th&gt;&lt;th&gt;When&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;tbody&gt;&lt;/tbody&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/table&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="row" style="margin-top:8px;"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;button id="resetLbBtn" style="min-width: 220px;"&gt;Reset Leaderboard&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="small"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>Tip: If your CMS blocks embeds, publish this app URL and link to it. Students can open it in a browser (and install it if allowed).</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;div id="toast" role="status" aria-live="polite"&gt;&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;script&gt;</span></p>
<p class="p1"><span class="s1">/** ------------------------------------------------------------------</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â </span>*<span class="Apple-converted-space">Â  </span>OPTIONAL PWA: install button + service worker registration</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â </span>*<span class="Apple-converted-space">Â  </span>------------------------------------------------------------------ */</span></p>
<p class="p1"><span class="s1">let deferredPrompt = null;</span></p>
<p class="p1"><span class="s1">const installBtn = document.getElementById("installBtn");</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">window.addEventListener("beforeinstallprompt", (e) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>e.preventDefault();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>deferredPrompt = e;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>installBtn.style.display = "inline-block";</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">installBtn.addEventListener("click", async () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>if (!deferredPrompt) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>deferredPrompt.prompt();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>await deferredPrompt.userChoice;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>deferredPrompt = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>installBtn.style.display = "none";</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">// Service worker (optional). Requires sw.js present and HTTPS hosting.</span></p>
<p class="p1"><span class="s1">if ("serviceWorker" in navigator) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>window.addEventListener("load", () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>navigator.serviceWorker.register("./sw.js").catch(() =&gt; {});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>});</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/** ------------------------------------------------------------------</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â </span>*<span class="Apple-converted-space">Â  </span>DOM</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â </span>*<span class="Apple-converted-space">Â  </span>------------------------------------------------------------------ */</span></p>
<p class="p1"><span class="s1">const startBtn = document.getElementById("startBtn");</span></p>
<p class="p1"><span class="s1">const dlBtn = document.getElementById("dlBtn");</span></p>
<p class="p1"><span class="s1">const scenarioEl = document.getElementById("scenario");</span></p>
<p class="p1"><span class="s1">const buttonsEl = document.getElementById("buttons");</span></p>
<p class="p1"><span class="s1">const mapEl = document.getElementById("map");</span></p>
<p class="p1"><span class="s1">const timeEl = document.getElementById("time");</span></p>
<p class="p1"><span class="s1">const healthEl = document.getElementById("health");</span></p>
<p class="p1"><span class="s1">const scoreEl = document.getElementById("score");</span></p>
<p class="p1"><span class="s1">const toastEl = document.getElementById("toast");</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">const nameEntryEl = document.getElementById("nameEntry");</span></p>
<p class="p1"><span class="s1">const teamNameInput = document.getElementById("teamNameInput");</span></p>
<p class="p1"><span class="s1">const saveTeamBtn = document.getElementById("saveTeamBtn");</span></p>
<p class="p1"><span class="s1">const skipSaveBtn = document.getElementById("skipSaveBtn");</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">const leaderboardBox = document.getElementById("leaderboard");</span></p>
<p class="p1"><span class="s1">const lbTableBody = document.querySelector("#lbTable tbody");</span></p>
<p class="p1"><span class="s1">const resetLbBtn = document.getElementById("resetLbBtn");</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/** ------------------------------------------------------------------</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â </span>*<span class="Apple-converted-space">Â  </span>Helpers</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â </span>*<span class="Apple-converted-space">Â  </span>------------------------------------------------------------------ */</span></p>
<p class="p1"><span class="s1">function toast(msg, ms = 2000) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>toastEl.textContent = msg;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>toastEl.style.display = "block";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>clearTimeout(toastEl._t);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>toastEl._t = setTimeout(() =&gt; (toastEl.style.display = "none"), ms);</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function escapeHtml(s) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>return String(s).replace(/[&amp;&lt;&gt;"']/g, (c) =&gt; ({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>"&amp;": "&amp;amp;",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>"&lt;": "&amp;lt;",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>"&gt;": "&amp;gt;",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>'"': "&amp;quot;",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>"'": "&amp;#39;"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>}[c]));</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function nowIso() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>return new Date().toISOString();</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/** ------------------------------------------------------------------</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â </span>*<span class="Apple-converted-space">Â  </span>Leaderboard (localStorage)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â </span>*<span class="Apple-converted-space">Â  </span>------------------------------------------------------------------ */</span></p>
<p class="p1"><span class="s1">const LB_KEY = "mission_secure_lb_v1";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function loadLeaderboard() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>try { return JSON.parse(localStorage.getItem(LB_KEY) || "[]"); }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>catch { return []; }</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function saveLeaderboard(lb) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>localStorage.setItem(LB_KEY, JSON.stringify(lb));</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function renderLeaderboard() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>const lb = loadLeaderboard()</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>.slice()</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>.sort((a, b) =&gt; (b.score - a.score))</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>.slice(0, 25);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>lbTableBody.innerHTML = "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>lb.forEach((e) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const tr = document.createElement("tr");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const when = new Date(e.ts);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>tr.innerHTML =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>`&lt;td&gt;${escapeHtml(e.team)}&lt;/td&gt;` +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>`&lt;td&gt;${e.score}&lt;/td&gt;` +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>`&lt;td&gt;${when.toLocaleString()}&lt;/td&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>lbTableBody.appendChild(tr);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>leaderboardBox.style.display = lb.length ? "block" : "none";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>dlBtn.disabled = !lb.length;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/** ------------------------------------------------------------------</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â </span>*<span class="Apple-converted-space">Â  </span>Game content</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â </span>*<span class="Apple-converted-space">Â  </span>------------------------------------------------------------------ */</span></p>
<p class="p1"><span class="s1">const networkNodes = ["Life Support", "Comms", "Satellite", "Food System", "Navigation"];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">const scenarios = [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>text: "Life Support monitoring is offline!",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>options: [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>{ text: "Check connections &amp; restart", correct: true, points: 10 },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>{ text: "Assume hackers; shut everything down", correct: false }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>lesson: "IT Support: start with basics (power, cables, restart)."</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>text: "Message received: 'URGENTâ€”log in here to fix power levels!'",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>options: [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>{ text: "Click the link immediately", correct: false },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>{ text: "Verify sender &amp; report phishing", correct: true, points: 15 }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>lesson: "Cybersecurity: phishing tricks humans into giving access."</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>text: "Unknown device is trying to access satellite controls.",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>options: [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>{ text: "Block traffic with the firewall", correct: true, points: 15 },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>{ text: "Ignore it", correct: false }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>lesson: "Network defense: block suspicious traffic; reduce attack paths."</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>text: "Crew member forgot their password.",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>options: [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>{ text: "Share your login so they can work", correct: false },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>{ text: "Reset password securely", correct: true, points: 10 }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>lesson: "Access control: never share credentials; reset properly."</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>text: "Two problems: security alert + a system outage.",</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>options: [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>{ text: "Fix the outage first", correct: false },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>{ text: "Handle the security alert first", correct: true, points: 20 }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>lesson: "Operations: prioritize threats that could impact everything."</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>}</span></p>
<p class="p1"><span class="s1">];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/** ------------------------------------------------------------------</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â </span>*<span class="Apple-converted-space">Â  </span>Game state</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â </span>*<span class="Apple-converted-space">Â  </span>------------------------------------------------------------------ */</span></p>
<p class="p1"><span class="s1">let health = 100;</span></p>
<p class="p1"><span class="s1">let score = 0;</span></p>
<p class="p1"><span class="s1">let timeLeft = 90;</span></p>
<p class="p1"><span class="s1">let timer = null;</span></p>
<p class="p1"><span class="s1">let round = 0;</span></p>
<p class="p1"><span class="s1">let infectedNode = null;</span></p>
<p class="p1"><span class="s1">let gameActive = false;</span></p>
<p class="p1"><span class="s1">let pendingEndMessage = "";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/** ------------------------------------------------------------------</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â </span>*<span class="Apple-converted-space">Â  </span>UI rendering</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â </span>*<span class="Apple-converted-space">Â  </span>------------------------------------------------------------------ */</span></p>
<p class="p1"><span class="s1">function updateHUD() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>timeEl.textContent = String(timeLeft);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>healthEl.textContent = String(health);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>scoreEl.textContent = String(score);</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function drawMap() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>mapEl.innerHTML = "&lt;b&gt;Network Map:&lt;/b&gt;&lt;br/&gt;";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>networkNodes.forEach((n) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const span = document.createElement("span");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>span.className = "node" + (n === infectedNode ? " infected" : "");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>span.textContent = n + (n === infectedNode ? " (INFECTED)" : "");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>mapEl.appendChild(span);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>});</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function setOptions(options) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>buttonsEl.innerHTML = "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>options.forEach((o) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const btn = document.createElement("button");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>btn.textContent = o.text;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>btn.onclick = () =&gt; onChoice(o);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>buttonsEl.appendChild(btn);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>});</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function hideNameEntry() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>nameEntryEl.style.display = "none";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>teamNameInput.value = "";</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function showNameEntry() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>nameEntryEl.style.display = "block";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>teamNameInput.focus();</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/** ------------------------------------------------------------------</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â </span>*<span class="Apple-converted-space">Â  </span>Game flow</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â </span>*<span class="Apple-converted-space">Â  </span>------------------------------------------------------------------ */</span></p>
<p class="p1"><span class="s1">function startMission() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>clearInterval(timer);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>timer = null;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>health = 100;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>score = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>timeLeft = 90;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>round = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>infectedNode = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>gameActive = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>pendingEndMessage = "";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>hideNameEntry();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>leaderboardBox.style.display = "none";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>scenarioEl.innerHTML = "Mission started. Stay sharp.";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>updateHUD();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>drawMap();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>timer = setInterval(() =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>if (!gameActive) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>timeLeft--;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>updateHUD();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>if (timeLeft &lt;= 0) finishMission("â± Timeâ€™s up. Mission ended.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>}, 1000);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>nextStep();</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function nextStep() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>if (!gameActive) return;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>if (health &lt;= 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>finishMission("ğŸ’¥ Station failed. Systems compromised.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>if (round &lt; scenarios.length) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const s = scenarios[round];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>scenarioEl.textContent = s.text;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>setOptions(s.options);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>drawMap();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>// Boss battle</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>ransomwareBoss();</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function onChoice(option) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>if (!gameActive) return;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>// Boss options</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>if (option.boss) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>if (option.correct) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>score += option.points || 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>updateHUD();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>toast("ğŸ‰ Contained! Isolation prevents spread; recovery can proceed.", 2400);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>finishMission("âœ… Mission success. Ransomware contained.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>health = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>updateHUD();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>toast("ğŸ’¥ Compromised! The attack spread across critical systems.", 2400);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>finishMission("ğŸ’¥ Mission failed. Ransomware spread across critical systems.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>// Normal scenarios</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>const s = scenarios[round];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>if (option.correct) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>score += option.points || 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>toast("âœ… Correct: " + s.lesson, 2400);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>health -= 15;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>toast("âŒ Wrong: station damaged. Think like an IT/Cyber team.", 2400);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>round++;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>updateHUD();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>setTimeout(nextStep, 250);</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function ransomwareBoss() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>infectedNode = networkNodes[Math.floor(Math.random() * networkNodes.length)];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>drawMap();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>scenarioEl.textContent =</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>`ğŸ¦  RANSOMWARE! ${infectedNode} is infected and encrypting files. What do you do?`;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>setOptions([</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>{ text: "Isolate/disconnect the infected system", correct: true, points: 30, boss: true },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>{ text: "Pay the ransom to restore access", correct: false, boss: true },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>{ text: "Ignore and hope it stops", correct: false, boss: true }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>]);</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function finishMission(message) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>if (!gameActive) return;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>gameActive = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>clearInterval(timer);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>timer = null;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>pendingEndMessage = message;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>buttonsEl.innerHTML = "";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>scenarioEl.textContent = message;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>// Ask for team name in-page (no prompt)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>showNameEntry();</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function saveScore(teamName) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>const team = (teamName || "").trim() || "Team";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>const entry = { team, score, ts: nowIso() };</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>const lb = loadLeaderboard();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>lb.push(entry);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>saveLeaderboard(lb);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>renderLeaderboard();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>hideNameEntry();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>leaderboardBox.style.display = "block";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>// Reset infection marker after end</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>infectedNode = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>drawMap();</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/** ------------------------------------------------------------------</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â </span>*<span class="Apple-converted-space">Â  </span>Downloads / reset</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â </span>*<span class="Apple-converted-space">Â  </span>------------------------------------------------------------------ */</span></p>
<p class="p1"><span class="s1">function downloadLeaderboardCsv() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>const lb = loadLeaderboard();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>if (!lb.length) return;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>const rows = [["Team", "Score", "Timestamp"]].concat(</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>lb.map((e) =&gt; [e.team, String(e.score), e.ts])</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>const csv = rows</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>.map((r) =&gt; r.map((cell) =&gt; `"${String(cell).replaceAll('"', '""')}"`).join(","))</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>.join("\n");</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>const blob = new Blob([csv], { type: "text/csv" });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>const a = document.createElement("a");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>a.href = URL.createObjectURL(blob);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>a.download = "mission_secure_leaderboard.csv";</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>a.click();</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function resetLeaderboard() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>if (!confirm("Reset leaderboard on this device?")) return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>saveLeaderboard([]);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>renderLeaderboard();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>toast("Leaderboard reset.", 1800);</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/** ------------------------------------------------------------------</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â </span>*<span class="Apple-converted-space">Â  </span>Event wiring</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â </span>*<span class="Apple-converted-space">Â  </span>------------------------------------------------------------------ */</span></p>
<p class="p1"><span class="s1">startBtn.addEventListener("click", startMission);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">dlBtn.addEventListener("click", downloadLeaderboardCsv);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">resetLbBtn.addEventListener("click", resetLeaderboard);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">saveTeamBtn.addEventListener("click", () =&gt; saveScore(teamNameInput.value));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">skipSaveBtn.addEventListener("click", () =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>hideNameEntry();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>infectedNode = null;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>drawMap();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>leaderboardBox.style.display = loadLeaderboard().length ? "block" : "none";</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">teamNameInput.addEventListener("keydown", (e) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>if (e.key === "Enter") saveScore(teamNameInput.value);</span></p>
<p class="p1"><span class="s1">});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/** ------------------------------------------------------------------</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â </span>*<span class="Apple-converted-space">Â  </span>Initial render</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â </span>*<span class="Apple-converted-space">Â  </span>------------------------------------------------------------------ */</span></p>
<p class="p1"><span class="s1">renderLeaderboard();</span></p>
<p class="p1"><span class="s1">drawMap();</span></p>
<p class="p1"><span class="s1">updateHUD();</span></p>
<p class="p1"><span class="s1">&lt;/script&gt;</span></p>
<p class="p1"><span class="s1">&lt;/body&gt;</span></p>
<p class="p1"><span class="s1">&lt;/html&gt;</span></p>
</body>
</html>
